<!doctype html>
<html>
<head>
    <title>FinanceTank</title>
    <meta charset='utf-8'/>
    <style type="text/css">
        html, body {
            overflow: hidden;
            font-family: Helvetica;
        }

    </style>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script>
        var ws;
        $(function () {
            var chat = $("#chat");
            $('#chat').height($(window).height() - 80);

            function wsStart() {
                ws = new WebSocket("ws://127.0.0.1:8002/");
                ws.onopen = function () {
                    chat.append("<p>система: соединение открыто</p>");
                    chat.scrollTop($('#chat')[0].scrollHeight);
                    if (paused) {
                        paused = false;
                    } else {
                        mainLoop();
                    }
                };
                ws.onclose = function () {
                    chat.append("<p>система: соединение закрыто, пытаюсь переподключиться</p>");
                    chat.scrollTop($('#chat')[0].scrollHeight);
                    paused = false;
                    setTimeout(wsStart, 1000);
                };
                ws.onmessage = function (evt) {
                    tanks = JSON.parse(evt.data);
                    //chat.append("<p>" + evt.data + "</p>");

                    //moveTank(tanks[0]);
                    draw();

                    chat.scrollTop($('#chat')[0].scrollHeight);
                };
            }

            wsStart();
        });

    </script>
</head>
<body>
<div id="canvasdiv" style="float: left;">
    <canvas id='field' tabindex="1">Canvas here</canvas>
    <p><b>W S A D</b> - move. <b>Ctrl/Space</b> - <font color="red">fire</font>, <b>Shift</b> - <font color="red">SUPERfire</font>, <b>L</b> - hold
        gun angle.</p>
</div>
<div style="float: left;">
    <div id='chat' style="float: up; display:block; background-color: #eeeeee; height: 700px; width: 200px;overflow: auto;"></div>
    <div style="float: up;">
        <form onsubmit="ws.send($('input').val()); $('input').val(''); return false; ">
            <input id="input" type="text" style="width: 180px;" class="form-control" placeholder="Text input" style="width: 100%;" maxlength="140" autocomplete="off">
        </form>
    </div>
</div>

<script src="game.js"></script>
</body>
</html>
